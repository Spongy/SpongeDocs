<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">




<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
     <title>Scheduler &mdash; Sponge 4.1.0 文档</title>
    
  <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sponge.css" type="text/css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href='//fonts.googleapis.com/css?family=Source+Code+Pro|Roboto:400italic,700italic,700,400' rel='stylesheet' type='text/css' />
  <link rel="stylesheet" href="../_static/tomorrow.css" type="text/css" />
  <link id="syntax-highlighting-ref" rel="stylesheet" href="../_static/tomorrow_night.css" type="text/css" />
      
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    '../',
      VERSION:     '4.1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/store.min.js"></script>
    <script type="text/javascript" src="../_static/lights.js"></script>
      <link rel="shortcut icon" href="../_static/favicon.ico"/>
        <link rel="top" title="Sponge 4.1.0 文档" href="../index.html" />
        <link rel="up" title="插件开发" href="index.html" />
        <link rel="next" title="服务" href="services.html" />
        <link rel="prev" title="Effects" href="effects.html" />
    
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-59476017-2', 'auto');
    ga('send', 'pageview');

  </script>
    
  <link rel="alternate" hreflang="da" href="/4.1.0/da/">
  <link rel="alternate" hreflang="de" href="/4.1.0/de/">
  <link rel="alternate" hreflang="en-GB" href="/4.1.0/en-GB/">
  <link rel="alternate" hreflang="en-PT" href="/4.1.0/en-PT/">
  <link rel="alternate" hreflang="en" href="/4.1.0/en/">
  <link rel="alternate" hreflang="es-ES" href="/4.1.0/es-ES/">
  <link rel="alternate" hreflang="fi" href="/4.1.0/fi/">
  <link rel="alternate" hreflang="fr" href="/4.1.0/fr/">
  <link rel="alternate" hreflang="it" href="/4.1.0/it/">
  <link rel="alternate" hreflang="ja" href="/4.1.0/ja/">
  <link rel="alternate" hreflang="ko" href="/4.1.0/ko/">
  <link rel="alternate" hreflang="lt" href="/4.1.0/lt/">
  <link rel="alternate" hreflang="nb" href="/4.1.0/nb/">
  <link rel="alternate" hreflang="nl" href="/4.1.0/nl/">
  <link rel="alternate" hreflang="pl" href="/4.1.0/pl/">
  <link rel="alternate" hreflang="pt-BR" href="/4.1.0/pt-BR/">
  <link rel="alternate" hreflang="pt-PT" href="/4.1.0/pt-PT/">
  <link rel="alternate" hreflang="ru" href="/4.1.0/ru/">
  <link rel="alternate" hreflang="uk" href="/4.1.0/uk/">
  <link rel="alternate" hreflang="zh-CN" href="/4.1.0/zh-CN/">
  <link rel="alternate" hreflang="zh-TW" href="/4.1.0/zh-TW/">
  <link rel="alternate" hreflang="x-default" href="/"> 
  </head>
  <body role="document" id="top">
    <div class="topbar">
  <div role="navigation" aria-label="related navigation">
    <div class="sp-logo-container sp-not-mobileview sp-mobileview">
      <a class="sp-logo-link" data-auto-route="true" href="/">
        <img height="40px" id="site-logo" class="logo-big" alt="Sponge Forums" src="../_static/spongelogo.png">
      </a>
      <div class="sp-logo-bg"></div>
      <div class="sp-logo-chevron"><i class="fa fa-fw fa-chevron-down"></i></div>
      <div class="sp-logo-menu sp-skip-handler">
        <ul class="sp-logo-dropdown" id="ddleft">
          <a href="https://www.spongepowered.org"><li><i class="fa-fw fa fa-home"></i>Homepage</li></a>
          <a href="https://forums.spongepowered.org"><li><i class="fa-fw fa fa-comment"></i>Forums</li></a>
          <a href="https://github.com/SpongePowered"><li><i class="fa-fw fa fa-code"></i>Code</li></a>
          <a class="sp-forums-home" href="https://docs.spongepowered.org"><li class="active"><i class="fa-fw fa fa-book"></i>SpongeDocs</li></a>
          <a href="https://jd.spongepowered.org"><li><i class="fa-fw fa fa-graduation-cap"></i>JavaDocs</li></a>
          <a href="https://forums.spongepowered.org/c/plugins/plugin-releases"><li><i class="fa-fw fa fa-plug"></i>Plugins</li></a>
          <a href="https://forums.spongepowered.org/t/sponge-downloads/11448"><li><i class="fa-fw fa fa-download"></i>Get Sponge</li></a>
        </ul>
      </div>
    </div>
    <div class="menu-right">
      <div><i class="fa fa-fw fa-globe"></i></div>
        <ul class="dropdown" id="ddlang">
          <li><a href="/4.1.0/da/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/da.png" alt="Flag for Danish"/></a></li>
          <li><a href="/4.1.0/de/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/de.png" alt="Flag for German"/></a></li>
          <li><a href="/4.1.0/en-GB/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/en-GB.png" alt="Flag for English, United Kingdom"/></a></li>
          <li><a href="/4.1.0/en-PT/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/en-PT.png" alt="Flag for Pirate English"/></a></li>
          <li><a href="/4.1.0/en/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/en.png" alt="Flag for English"/></a></li>
          <li><a href="/4.1.0/es-ES/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/es-ES.png" alt="Flag for Spanish"/></a></li>
          <li><a href="/4.1.0/fi/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/fi.png" alt="Flag for Finnish"/></a></li>
          <li><a href="/4.1.0/fr/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/fr.png" alt="Flag for French"/></a></li>
          <li><a href="/4.1.0/it/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/it.png" alt="Flag for Italian"/></a></li>
          <li><a href="/4.1.0/ja/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/ja.png" alt="Flag for Japanese"/></a></li>
          <li><a href="/4.1.0/ko/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/ko.png" alt="Flag for Korean"/></a></li>
          <li><a href="/4.1.0/lt/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/lt.png" alt="Flag for Lithuanian"/></a></li>
          <li><a href="/4.1.0/nb/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/nb.png" alt="Flag for Norwegian Bokmal"/></a></li>
          <li><a href="/4.1.0/nl/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/nl.png" alt="Flag for Dutch"/></a></li>
          <li><a href="/4.1.0/pl/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/pl.png" alt="Flag for Polish"/></a></li>
          <li><a href="/4.1.0/pt-BR/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/pt-BR.png" alt="Flag for Portuguese, Brazilian"/></a></li>
          <li><a href="/4.1.0/pt-PT/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/pt-PT.png" alt="Flag for Portuguese"/></a></li>
          <li><a href="/4.1.0/ru/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/ru.png" alt="Flag for Russian"/></a></li>
          <li><a href="/4.1.0/uk/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/uk.png" alt="Flag for Ukrainian"/></a></li>
          <li><a href="/4.1.0/zh-CN/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/zh-CN.png" alt="Flag for Chinese Simplified"/></a></li>
          <li><a href="/4.1.0/zh-TW/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/zh-TW.png" alt="Flag for Chinese Traditional"/></a></li>
        </ul>
    </div>
    <div class="menu-right">
      <div><i class="fa fa-fw fa-tag"></i><a>4.1.0</a></div>
        <ul class="dropdown" id="ddvers">
          <li><a href="/master/en/"><i class="fa fa-fw fa-tag"></i> latest</a></li>
          <li><a href="/4.1.0/en/"><i class="fa fa-fw fa-tag"></i> 4.1.0</a></li>
          <li><a href="/3.1.0/en/"><i class="fa fa-fw fa-tag"></i> 3.1.0</a></li>
        </ul>
    </div>
    <div class="menu-right">
      <div title="Toggle syntax highlighting between light and dark" class="lights">
        <i class="fa fa-fw fa-lightbulb-o"></i>
      </div>
    </div>
    <div>
      <ul class="controls">
        <li>|</li>
        
        <li><a href="services.html" title="Next Page"><i class="fa fa-fw fa-chevron-right"></i></a></li>
        
        <li><a href="#top" title="To the top"><i class="fa fa-fw fa-chevron-up"></i></a></li>
        <li><a href="../index.html" title="Home"><i class="fa fa-fw fa-home"></i></a></li>
        
        <li><a href="effects.html" title="Previous Page"><i class="fa fa-fw fa-chevron-left"></i></a></li>
        
        <li>|</li>
        
          <li><a href="https://github.com/SpongePowered/SpongeDocs/blob/master/source/plugin/scheduler.rst" title="Edit on GitHub"><i class="fa fa-fw fa-github"></i></a></li>
        
      </ul>
    </div>
    <h3>导航</h3>
  </div>
    </div>
    <div class="container">

      <div class="breadcrumbs">
        <ul>
        <li><a href="../index.html">Sponge 4.1.0 文档</a><i class="fa fa-fw fa-chevron-right"></i></li>
        <li><a href="index.html" accesskey="U">插件开发</a><i class="fa fa-fw fa-chevron-right"></i></li>
        </ul>
      </div> 
    <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
      <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
    <form class="search" action="../search.html" method="get">
      <div class="searchbox-inner">
        <input class="field" type="text" name="q" autocomplete="off" />
        <button class="submit" type="submit"><i class="fa fa-fw fa-search" aria-hidden="true"></i></button>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </div>
    </form>
    <p class="searchtip" style="font-size: 90%"></p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3><a href="../index.html">內容目录</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../server/index.html">创建服务器</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../server/getting-started/index.html">入门指南</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../server/getting-started/jre.html">安装 Java</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/getting-started/migrating.html">迁移到 Sponge</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/getting-started/implementations/index.html">选择一个安装启动</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../server/getting-started/implementations/spongeforge.html">Installing SpongeForge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../server/getting-started/implementations/spongevanilla.html">Installing SpongeVanilla</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/getting-started/launch-script.html">创建启动脚本</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/getting-started/port-forward.html">端口转发</a></li>
<li class="toctree-l3"><a class="reference internal" href="../server/getting-started/bungeecord.html">和BungeeCorge配合使用Sponge</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/getting-started/configuration/index.html">配置Sponge</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../server/getting-started/configuration/hocon.html">HOCON 简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="../server/getting-started/configuration/json.html">JSON 语法</a></li>
<li class="toctree-l4"><a class="reference internal" href="../server/getting-started/configuration/sponge-conf.html">global.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../server/getting-started/configuration/server-properties.html">server.properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../server/management/index.html">服务器管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../server/management/whitelist.html">管理白名单</a></li>
<li class="toctree-l3"><a class="reference internal" href="../server/management/bans.html">管理—封禁</a></li>
<li class="toctree-l3"><a class="reference internal" href="../server/management/permissions.html">权限管理</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/management/plugins.html">安装插件</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/management/exploit-patches.html">Exploit Patches</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/management/performance-tweaks.html">Performance Tweaks</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../server/spongineer/index.html">成为Sponge专家</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../server/spongineer/commands.html">命令</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/spongineer/troubleshooting.html">故障排查</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/spongineer/logs.html">日志文件</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/spongineer/debugging.html">Debugging</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../server/spongineer/bugreport.html">Reporting Bugs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preparing/index.html">为开发做准备</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../preparing/jdk.html">安装JDK</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../preparing/ide.html">安装IDE</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../preparing/text.html">安装一个文本编辑器</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../preparing/git.html">安装Git</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">插件开发</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="buildsystem.html">构建系统</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="workspace/index.html">建立工作目录</a><ul>
<li class="toctree-l3"><a class="reference internal" href="workspace/idea.html">设置 IntelliJ IDEA</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="workspace/eclipse.html">设置 Eclipse</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="project/index.html">设置你的项目</a><ul>
<li class="toctree-l3"><a class="reference internal" href="project/gradle.html">设置 Gradle</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="project/maven.html">设置 Maven</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugin-identifier.html">插件标识符</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-class.html">插件的主类</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lifecycle.html">插件周期</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="injection.html">依赖注入</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="practices.html">最佳做法</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="optional/index.html">使用 Optional</a><ul>
<li class="toctree-l3"><a class="reference internal" href="optional/basic.html">对于 Optional 的解释</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="optional/usage.html">用法示例</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">日志记录和调试</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/index.html">命令</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/creating.html">创建一个命令</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="commands/arguments.html">参数分析</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="commands/flags.html">命令标志</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="commands/childcommands.html">子命令</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/service.html">命令管理器</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/commandcallable.html">低级别命令 API</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="event/index.html">事件</a><ul>
<li class="toctree-l3"><a class="reference internal" href="event/listeners.html">事件监听器</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="event/causes.html">事件原因</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="event/filters.html">事件过滤</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="event/custom.html">自定义事件</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="assets.html">使用 Asset API</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration/index.html">插件配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration/loaders.html">配置加载器</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="configuration/nodes.html">配置节点</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="configuration/serialization.html">序列化对象</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="text/index.html">文本 API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="text/text.html">创建文本</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="text/representations/index.html">序列化文本</a><ul>
<li class="toctree-l4"><a class="reference internal" href="text/representations/formatting-code-legacy.html">Formatting Code &amp; Legacy Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="text/representations/xml.html">TextXML Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="text/representations/json.html">JSON Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="text/representations/configurate.html">Configuration Format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="text/pagination.html">分页</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="text/messagechannels.html">消息通道</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="text/templates.html">文本模板</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data/index.html">数据 API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data/keys.html">使用数据键</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data/datamanipulators.html">操作数据</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data/transactions.html">数据操作记录</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data/serialization.html">序列化数据</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="blocks/index.html">方块</a><ul>
<li class="toctree-l3"><a class="reference internal" href="blocks/concepts.html">概念</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="blocks/accessing.html">访问方块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="blocks/modifying.html">修改方块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="blocks/tileentities.html">Tile Entity</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="blocks/virtualblock.html">虚拟方块更改</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="entities/index.html">实体</a><ul>
<li class="toctree-l3"><a class="reference internal" href="entities/spawning.html">生成一个实体</a></li>
<li class="toctree-l3"><a class="reference internal" href="entities/modifying.html">修改一个实体</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="items/index.html">Items</a><ul>
<li class="toctree-l3"><a class="reference internal" href="items/usage.html">Basic Item Usage</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="items/creating.html">Creating an ItemStack</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="effects.html">Effects</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Scheduler</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="services.html">服务</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="database.html">Databases</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="permissions.html">Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="bans.html">Bans</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bookview.html">Book Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="economy/index.html">Economy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="economy/basics.html">Basic Concepts</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="economy/using.html">Using the Economy API</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="economy/practices.html">Economy API Best Practices</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="economy/implementing.html">Implementing the Economy API</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wgen/index.html">World Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="wgen/modifiers.html">WorldGeneratorModifiers</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="wgen/customwgen.html">Modifying World Generation</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="manager.html">Plugin Manager</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="game-profile-manager.html">Game Profile Manager</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="offline-userplayer-data.html">Offline Player Data</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Plugin Debugging</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tab-lists.html">Tab Lists</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugin-meta.html">插件的元数据</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ray-tracing.html">Ray Tracing</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bukkit-sponge-compare.html">Comparing Bukkit to SpongeAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html">教程</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">向 Sponge 贡献代码</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/guidelines.html">贡献指南</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/howtogit.html">如何使用Git（Hub）</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/implementation/index.html">Developing Sponge</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing/implementation/codestyle.html">代码规范</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/implementation/git-implementation.html">Git Workflow for API and Implementations</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/implementation/pr.html">Submitting a Pull-Request</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/implementation/debugging.html">在IDE中调试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/implementation/mixins.html">Mixin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/implementation/datamanipulator.html">Implementing DataManipulators</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/spongedocs.html">SpongeDocs文稿</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/porting.html">将Sponge移植到其他平台</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/versioning.html">Versioning System and Repository Branch Layout</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">关于 Sponge 项目</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/introduction.html">简介</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/faq.html">常见问题</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/structure.html">The Structure of the Sponge Project</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/future.html">未来计划</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/license.html">许可</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/posting.html">论坛发帖准则</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/rules.html">论坛及 IRC 准则</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/staff.html">工作人员</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/glossary.html">Sponge 术语表</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/assets.html">艺术资源</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/history.html">Sponge的历史</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../downloads.html">下载</a><ul class="simple">
</ul>
</li>
</ul>
<ul class="simple">
</ul>

      </div>
    </div> 

        <div class="document">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body" role="main">
                  
  <div class="section" id="scheduler">
<h1>Scheduler<a class="headerlink" href="#scheduler" title="永久链接至标题">¶</a></h1>
<p>Sponge exposes the <a class="reference external" href="https://jd.spongepowered.org/4.1.0/org/spongepowered/api/scheduler/Scheduler.html">Scheduler</a> to allow you to designate tasks to be executed in the future. The <code class="docutils literal"><span class="pre">Scheduler</span></code>
provides a <a class="reference external" href="https://jd.spongepowered.org/4.1.0/org/spongepowered/api/scheduler/Task.Builder.html">Task.Builder</a> with which you can specify task properties such as the delay, interval, name,
(a)synchronicity, and <code class="docutils literal"><span class="pre">Runnable</span></code> (see <a class="reference internal" href="#task-properties"><span>Task Properties</span></a>).</p>
<div class="section" id="task-builder">
<h2>Task Builder<a class="headerlink" href="#task-builder" title="永久链接至标题">¶</a></h2>
<p>First, obtain an instance of the <code class="docutils literal"><span class="pre">Scheduler</span></code>, and retrieve the <code class="docutils literal"><span class="pre">Task.Builder</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.scheduler.Scheduler</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.scheduler.Task</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.Sponge</span><span class="o">;</span>

<span class="n">Scheduler</span> <span class="n">scheduler</span> <span class="o">=</span> <span class="n">Sponge</span><span class="o">.</span><span class="na">getScheduler</span><span class="o">();</span>
<span class="n">Task</span><span class="o">.</span><span class="na">Builder</span> <span class="n">taskBuilder</span> <span class="o">=</span> <span class="n">scheduler</span><span class="o">.</span><span class="na">createTaskBuilder</span><span class="o">();</span>
</pre></div>
</div>
<p>The only required property is the <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html">Runnable</a>,
which you can specify using <a class="reference external" href="https://jd.spongepowered.org/4.1.0/org/spongepowered/api/scheduler/Task.Builder.html#execute-java.lang.Runnable-">Task.Builder#execute(Runnable)</a>:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">taskBuilder</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&quot;Yay! Schedulers!&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">});</span>
</pre></div>
</div>
<p>or using Java 8 syntax with <code class="docutils literal"><span class="pre">Task.Builder#execute(Runnable</span> <span class="pre">runnable)</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">taskBuilder</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span>
    <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&quot;Yay! Schedulers!&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">);</span>
</pre></div>
</div>
<p>or using Java 8 syntax with <code class="docutils literal"><span class="pre">Task.Builder#execute(Consumer&lt;Task&gt;</span> <span class="pre">task)</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">taskBuilder</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span>
    <span class="n">task</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&quot;Yay! Schedulers! :&quot;</span> <span class="o">+</span> <span class="n">task</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">);</span>
</pre></div>
</div>
<div class="section" id="task-properties">
<span id="id1"></span><h3>Task Properties<a class="headerlink" href="#task-properties" title="永久链接至标题">¶</a></h3>
<p>Using the <code class="docutils literal"><span class="pre">Task.Builder</span></code>, you can specify other, optional properties, as described below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="22%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Method Used</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>delay</td>
<td><p class="first">delayTicks(long delay)</p>
<dl class="last docutils">
<dt>delay(long delay,</dt>
<dd>TimeUnit unit)</dd>
</dl>
</td>
<td><p class="first">The optional amount of time to pass before the task is to be run.</p>
<p>The time is specified as a number of ticks with the <code class="docutils literal"><span class="pre">delayTicks()</span></code>
method, or it may be provided as a number of a more convenient time
unit by specifying a <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html">TimeUnit</a> with the delay() method.</p>
<p class="last"><em>Either method, but not both, can specified per task.</em></p>
</td>
</tr>
<tr class="row-odd"><td>interval</td>
<td><dl class="first last docutils">
<dt>intervalTicks(</dt>
<dd>long interval)</dd>
<dt>interval(long interval,</dt>
<dd>TimeUnit unit)</dd>
</dl>
</td>
<td><p class="first">The amount of time between repetitions of the task.  If an interval is
not specified, the task will not be repeated.</p>
<p>The time is specified as a number of ticks with the <code class="docutils literal"><span class="pre">intervalTicks()</span></code>
method, or it may be provided as a number of a more convenient time
unit by specifying a <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html">TimeUnit</a> with the interval() method.</p>
<p class="last"><em>Either method, but not both, can specified per task.</em></p>
</td>
</tr>
<tr class="row-even"><td>synchronization</td>
<td>async()</td>
<td>A synchronous task is run in the game&#8217;s main loop in series with the
tick cycle. If <code class="docutils literal"><span class="pre">Task.Builder#async</span></code> is used, the task will be run
asynchronously. Therefore, it will run in its own thread, independently
of the tick cycle, and may not safely use game state.
(See <a class="reference internal" href="#asynchronous-tasks">Asynchronous Tasks</a>.)</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>name(String name)</td>
<td>The name of the task. By default, the name of the task will be
PLUGIN_ID &#8220;-&#8221; ( &#8220;A-&#8221; | &#8220;S-&#8221; ) SERIAL_ID. For example, a default task name
could look like &#8220;FooPlugin-A-12&#8221;. No two active tasks will have the same
serial ID for the same synchronization type. If a task name is specified,
it should be descriptive and aid users in debugging your plugin.</td>
</tr>
</tbody>
</table>
<p>Lastly, submit the task to the scheduler using <a class="reference external" href="https://jd.spongepowered.org/4.1.0/org/spongepowered/api/scheduler/Task.Builder.html#submit-java.lang.Object-">Task.Builder#submit(Object)</a>.</p>
<p>And that&#8217;s it! To summarize, a fully functional scheduled task that would run asynchronously every 5 minutes after an
initial delay of 100 milliseconds could be built and submitted using the following code:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.concurrent.TimeUnit</span><span class="o">;</span>

<span class="n">Scheduler</span> <span class="n">scheduler</span> <span class="o">=</span> <span class="n">Sponge</span><span class="o">.</span><span class="na">getScheduler</span><span class="o">();</span>
<span class="n">Task</span><span class="o">.</span><span class="na">Builder</span> <span class="n">taskBuilder</span> <span class="o">=</span> <span class="n">scheduler</span><span class="o">.</span><span class="na">createTaskBuilder</span><span class="o">();</span>

<span class="n">Task</span> <span class="n">task</span> <span class="o">=</span> <span class="n">taskBuilder</span><span class="o">.</span><span class="na">execute</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&quot;Yay! Schedulers!&quot;</span><span class="o">))</span>
    <span class="o">.</span><span class="na">async</span><span class="o">().</span><span class="na">delay</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">MILLISECONDS</span><span class="o">).</span><span class="na">interval</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">MINUTES</span><span class="o">)</span>
    <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&quot;ExamplePlugin - Fetch Stats from Database&quot;</span><span class="o">).</span><span class="na">submit</span><span class="o">(</span><span class="n">plugin</span><span class="o">);</span>
</pre></div>
</div>
<p>To cancel a task, simply call the <a class="reference external" href="https://jd.spongepowered.org/4.1.0/org/spongepowered/api/scheduler/Task.html#cancel--">Task#cancel()</a> method:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">task</span><span class="o">.</span><span class="na">cancel</span><span class="o">();</span>
</pre></div>
</div>
<p>If you need to cancel the task from within the runnable itself, you can instead opt to use a <code class="docutils literal"><span class="pre">Consumer&lt;Task&gt;`</span></code> in
order to access the task. The below example will schedule a task that will count down from 60 and cancel itself upon
reaching 0.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Listener</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onGameInit</span><span class="o">(</span><span class="n">GameInitializationEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Scheduler</span> <span class="n">scheduler</span> <span class="o">=</span> <span class="n">Sponge</span><span class="o">.</span><span class="na">getScheduler</span><span class="o">();</span>
    <span class="n">Task</span><span class="o">.</span><span class="na">Builder</span> <span class="n">taskBuilder</span> <span class="o">=</span> <span class="n">scheduler</span><span class="o">.</span><span class="na">createTaskBuilder</span><span class="o">();</span>
    <span class="n">Task</span> <span class="n">task</span> <span class="o">=</span> <span class="n">taskBuilder</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">new</span> <span class="n">CancellingTimerTask</span><span class="o">())</span>
        <span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">&quot;Self-Cancelling Timer Task&quot;</span><span class="o">).</span><span class="na">submit</span><span class="o">(</span><span class="n">plugin</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kd">class</span> <span class="nc">CancellingTimerTask</span> <span class="kd">implements</span> <span class="n">Consumer</span><span class="o">&lt;</span><span class="n">Task</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">seconds</span> <span class="o">=</span> <span class="mi">60</span><span class="o">;</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="n">Task</span> <span class="n">task</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">seconds</span><span class="o">--;</span>
        <span class="n">Sponge</span><span class="o">.</span><span class="na">getServer</span><span class="o">()</span>
            <span class="o">.</span><span class="na">getBroadcastChannel</span><span class="o">()</span>
            <span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">Text</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">&quot;Remaining Time: &quot;</span><span class="o">+</span><span class="n">seconds</span><span class="o">+</span><span class="s">&quot;s&quot;</span><span class="o">));</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">task</span><span class="o">.</span><span class="na">cancel</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="asynchronous-tasks">
<h3>Asynchronous Tasks<a class="headerlink" href="#asynchronous-tasks" title="永久链接至标题">¶</a></h3>
<p>Asynchronous tasks should be used primarily for code that may take a significant period of time to execute, namely
requests to another server or database. If done on the main thread, a request to another server could greatly impact
the performance of the game, since the next tick cannot be fired until the request is completed.</p>
<p>Since Minecraft is largely single-threaded, there is little you can do in an asynchronous thread. If you must run a
thread asynchronously, you should execute all of the code that does not use the SpongeAPI/affect Minecraft, then register
another <cite>synchronous</cite> task to handle the code that needs the API. There are a few parts of Minecraft that you can work
with <cite>asynchronously</cite>, including:</p>
<ul class="simple">
<li>Chat</li>
<li>Sponge&#8217;s built-in Permissions handling</li>
<li>Sponge&#8217;s scheduler</li>
</ul>
<p>In addition, there are a few other operations that are safe to do asynchronously:</p>
<ul class="simple">
<li>Independent network requests</li>
<li>Filesystem I/O (excluding files used by Sponge)</li>
</ul>
</div>
</div>
<div class="section" id="compatibility-with-other-libraries">
<h2>Compatibility with other libraries<a class="headerlink" href="#compatibility-with-other-libraries" title="永久链接至标题">¶</a></h2>
<p>As your plugin grows in size and scope you might want to start using one of the many concurrency libraries available
for Java and the JVM.
These libraries do tend to support Java&#8217;s
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html">ExecutorService</a> as a means
of directing on which thread the task is executed.</p>
<p>To allow these libraries to work with Sponge&#8217;s <code class="docutils literal"><span class="pre">Scheduler</span></code> the following methods can be used:</p>
<ul class="simple">
<li><a class="reference external" href="https://jd.spongepowered.org/4.1.0/org/spongepowered/api/scheduler/Scheduler.html#createSyncExecutor-java.lang.Object-">Scheduler#createSyncExecutor(Object)</a> creates a <a class="reference external" href="https://jd.spongepowered.org/4.1.0/org/spongepowered/api/scheduler/SpongeExecutorService.html">SpongeExecutorService</a> which executes tasks
through Sponge&#8217;s synchronous scheduler.</li>
<li><a class="reference external" href="https://jd.spongepowered.org/4.1.0/org/spongepowered/api/scheduler/Scheduler.html#createAsyncExecutor-java.lang.Object-">Scheduler#createAsyncExecutor(Object)</a> creates a <code class="docutils literal"><span class="pre">SpongeExecutorService</span></code> which executes tasks through
Sponge&#8217;s asynchronous scheduler. Tasks are subject to the restrictions mentioned in <a class="reference internal" href="#asynchronous-tasks">Asynchronous Tasks</a>.</li>
</ul>
<p>One thing to keep in mind is that any tasks that interacts with Sponge outside of the interactions listed in
<a class="reference internal" href="#asynchronous-tasks">Asynchronous Tasks</a> need to be executed on the ExecutorService created with  <code class="docutils literal"><span class="pre">Scheduler#createSyncExecutor(Object)</span></code>
to be thread-safe.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.scheduler.SpongeExecutorService</span><span class="o">;</span>

<span class="n">SpongeExecutorService</span> <span class="n">minecraftExecutor</span> <span class="o">=</span> <span class="n">Sponge</span><span class="o">.</span><span class="na">getScheduler</span><span class="o">().</span><span class="na">createSyncExecutor</span><span class="o">(</span><span class="n">plugin</span><span class="o">);</span>

<span class="n">minecraftExecutor</span><span class="o">.</span><span class="na">submit</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">});</span>

<span class="n">minecraftExecutor</span><span class="o">.</span><span class="na">schedule</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">},</span> <span class="mi">10</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
</pre></div>
</div>
<p>Almost all libraries have some way of adapting the <code class="docutils literal"><span class="pre">ExecutorService</span></code> to natively schedule tasks.
As an example the following paragraphs will explain how the <code class="docutils literal"><span class="pre">ExecutorService</span></code> is used in a number of libraries.</p>
<div class="section" id="completablefuture-java-8">
<h3>CompletableFuture (Java 8)<a class="headerlink" href="#completablefuture-java-8" title="永久链接至标题">¶</a></h3>
<p>With Java 8 the <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html">CompletableFuture</a> object was added to the standard library.
Compared to the <code class="docutils literal"><span class="pre">Future</span></code> object, this allows for the developer to provide a callback that is called when the future
completes rather than blocking the thread until the future eventually completes.</p>
<p><a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html">CompletableFuture</a> is a fluent interface which usually has the following three variations for each of its functions:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">CompletableFuture#&lt;function&gt;Async(...,</span> <span class="pre">Executor</span> <span class="pre">ex)</span></code> Executes this function through <code class="docutils literal"><span class="pre">ex</span></code></li>
<li><code class="docutils literal"><span class="pre">CompletableFuture#&lt;function&gt;Async(...)</span></code> Executes this function through <code class="docutils literal"><span class="pre">ForkJoinPool.commonPool()</span></code></li>
<li><code class="docutils literal"><span class="pre">CompletableFuture#&lt;function&gt;(...)</span></code> Executes this function on whatever thread the previous <code class="docutils literal"><span class="pre">CompletableFuture</span></code> was completed on.</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.concurrent.CompletableFuture</span><span class="o">;</span>

<span class="n">SpongeExecutorService</span> <span class="n">minecraftExecutor</span> <span class="o">=</span> <span class="n">Sponge</span><span class="o">.</span><span class="na">getScheduler</span><span class="o">().</span><span class="na">createSyncExecutor</span><span class="o">(</span><span class="n">plugin</span><span class="o">);</span>

<span class="n">CompletableFuture</span><span class="o">.</span><span class="na">supplyAsync</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// ASYNC: ForkJoinPool.commonPool()</span>
    <span class="k">return</span> <span class="mi">42</span><span class="o">;</span>
<span class="o">}).</span><span class="na">thenAcceptAsync</span><span class="o">((</span><span class="n">awesomeValue</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// SYNC: minecraftExecutor</span>
<span class="o">},</span> <span class="n">minecraftExecutor</span><span class="o">).</span><span class="na">thenRun</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// SYNC: minecraftExecutor</span>
<span class="o">});</span>
</pre></div>
</div>
</div>
<div class="section" id="rxjava">
<h3>RxJava<a class="headerlink" href="#rxjava" title="永久链接至标题">¶</a></h3>
<p><a class="reference external" href="https://github.com/ReactiveX/RxJava">RxJava</a> is an implementation of the
<a class="reference external" href="http://reactivex.io/">Reactive Extensions</a> concept for the JVM.</p>
<p>Multithreading in Rx is managed through various
<a class="reference external" href="http://reactivex.io/documentation/scheduler.html">Schedulers</a>.
Using the <code class="docutils literal"><span class="pre">Schedulers#from(Executor</span> <span class="pre">executor)</span></code> function the <code class="docutils literal"><span class="pre">Executor</span></code> provided by Sponge can be turned into a
<code class="docutils literal"><span class="pre">Scheduler</span></code>.</p>
<p>Much like <code class="docutils literal"><span class="pre">CompletableFuture</span></code> by default actions are executed on the same thread that completed the previous part
of the chain.
Use <code class="docutils literal"><span class="pre">Observable#observeOn(Scheduler</span> <span class="pre">scheduler)</span></code> to move between threads.</p>
<p>One important thing to bear in mind is that the root <code class="docutils literal"><span class="pre">Observable</span></code> gets invoked on whatever thread
<code class="docutils literal"><span class="pre">Observable#subscribe()</span></code> was called on. If the root observable interacts with Sponge it should be forced to run
synchronously using <code class="docutils literal"><span class="pre">Observable#subscribeOn(Scheduler</span> <span class="pre">scheduler)</span></code>.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rx.Observable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">rx.Scheduler</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">rx.schedulers.Schedulers</span><span class="o">;</span>

<span class="n">SpongeExecutorService</span> <span class="n">executor</span> <span class="o">=</span> <span class="n">Sponge</span><span class="o">.</span><span class="na">getScheduler</span><span class="o">().</span><span class="na">createSyncExecutor</span><span class="o">(</span><span class="n">plugin</span><span class="o">);</span>
<span class="n">Scheduler</span> <span class="n">minecraftScheduler</span> <span class="o">=</span> <span class="n">Schedulers</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">executor</span><span class="o">);</span>

<span class="n">Observable</span><span class="o">.</span><span class="na">defer</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">Observable</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">Sponge</span><span class="o">.</span><span class="na">getServer</span><span class="o">().</span><span class="na">getOnlinePlayers</span><span class="o">()))</span>
          <span class="o">.</span><span class="na">subscribeOn</span><span class="o">(</span><span class="n">minecraftScheduler</span><span class="o">)</span> <span class="c1">// defer -&gt; SYNC: minecraftScheduler</span>
          <span class="o">.</span><span class="na">observeOn</span><span class="o">(</span><span class="n">Schedulers</span><span class="o">.</span><span class="na">io</span><span class="o">())</span> <span class="c1">// -&gt; ASYNC: Schedulers.io()</span>
          <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">player</span> <span class="o">-&gt;</span> <span class="o">{</span>
              <span class="c1">// ASYNC: Schedulers.io()</span>
              <span class="k">return</span> <span class="s">&quot;Flards&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">player</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
          <span class="o">})</span>
          <span class="o">.</span><span class="na">observeOn</span><span class="o">(</span><span class="n">minecraftScheduler</span><span class="o">)</span> <span class="c1">// -&gt; SYNC: minecraftScheduler</span>
          <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">player</span> <span class="o">-&gt;</span> <span class="o">{</span>
              <span class="c1">// SYNC: minecraftScheduler</span>
              <span class="n">player</span><span class="o">.</span><span class="na">kick</span><span class="o">(</span><span class="n">Text</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">&quot;Computer says no&quot;</span><span class="o">));</span>
          <span class="o">});</span>
</pre></div>
</div>
</div>
<div class="section" id="scala">
<h3>Scala<a class="headerlink" href="#scala" title="永久链接至标题">¶</a></h3>
<p>Scala comes with a built-in <a class="reference external" href="http://www.scala-lang.org/api/current/#scala.concurrent.Future">Future</a> object which
a lot of scala framework mirror in design.
Most methods of the Future accept an
<a class="reference external" href="http://www.scala-lang.org/api/current/index.html#scala.concurrent.ExecutionContext$">ExecutionContext</a> which
determined where that part of the operation is executed.
This is different from the CompletableFuture or RxJava since they default to executing on the same thread on which
the previous operation ended.</p>
<p>The fact that all these operation try to implicitly find an <code class="docutils literal"><span class="pre">ExecutionContext</span></code> means that you can easily use
the default <code class="docutils literal"><span class="pre">ExecutionContext.global</span></code> and specifically run the parts that need to be thread-safe on the Sponge
server thread.</p>
<p>To avoid accidentally scheduling work on through the Sponge <code class="docutils literal"><span class="pre">ExecutorContext</span></code> another context should be implicitly
defined so it acts as the default choice. To maintain thread safety only the functions that actually interact with Sponge
will need to have the Sponge executor specified.</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">scala.concurrent.ExecutionContext</span>

<span class="k">val</span> <span class="n">executor</span> <span class="k">=</span> <span class="nc">Sponge</span><span class="o">.</span><span class="n">getScheduler</span><span class="o">().</span><span class="n">createSyncExecutor</span><span class="o">(</span><span class="n">plugin</span><span class="o">)</span>

<span class="k">import</span> <span class="nn">ExecutionContext.Implicits.global</span>
<span class="k">val</span> <span class="n">ec</span> <span class="k">=</span> <span class="nc">ExecutionContext</span><span class="o">.</span><span class="n">fromExecutorService</span><span class="o">(</span><span class="n">executor</span><span class="o">)</span>

<span class="k">val</span> <span class="n">future</span> <span class="k">=</span> <span class="nc">Future</span> <span class="o">{</span>
    <span class="c1">// ASYNC: ExecutionContext.Implicits.global</span>
<span class="o">}</span>

<span class="n">future</span> <span class="n">foreach</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">value</span> <span class="k">=&gt;</span> <span class="c1">// SYNC: ec</span>
<span class="o">}(</span><span class="n">ec</span><span class="o">)</span>

<span class="n">future</span> <span class="n">map</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">value</span> <span class="k">=&gt;</span> <span class="mi">42</span> <span class="c1">// SYNC: ec</span>
<span class="o">}(</span><span class="n">ec</span><span class="o">).</span><span class="n">foreach</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">value</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="c1">// ASYNC: ExecutionContext.Implicits.global</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>


                </div>
              </div>
            </div>
          <div class="clearer"></div>
        </div>
        <div class="footer" role="contentinfo">
              &copy; 版权所有 2014-2016, Sponge Contributors.
            由 <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3 创建。
        </div>
    </div>
  </body>
</html>